ARG BASE_IMAGE=neo4j:5.27-community
FROM ${BASE_IMAGE}

# Set data environment variables from build/run args
ARG DATA_NONREL_DB
ARG DATA_NONREL_USER
ARG DATA_NONREL_PASSWORD
ARG DATA_NONREL_PORT_HOST
ARG DATA_NONREL_PORT_CONTAINER

ENV NEO4J_AUTH=${DATA_NONREL_USER}/${DATA_NONREL_PASSWORD}
ENV NEO4J_dbms_default__database=${DATA_NONREL_DB}
ENV DATA_NONREL_PORT_HOST=${DATA_NONREL_PORT_HOST}
ENV DATA_NONREL_PORT_CONTAINER=${DATA_NONREL_PORT_CONTAINER}

# Install unzip for data import
USER root
RUN apt-get update && apt-get install -y unzip && rm -rf /var/lib/apt/lists/*
USER neo4j

# Expose Neo4j ports (7474 for HTTP, 7687 for Bolt protocol)
EXPOSE 7474 7687 ${DATA_NONREL_PORT_HOST} ${DATA_NONREL_PORT_CONTAINER}
